import{j as e,L as w,a as v,C as $,b as D,c as E,r as d,d as R,e as F,f as B,g as H,h as M,i as U,k as A,l as K,m as q,U as z,n as G,o as J}from"./index-BeoHRLrB.js";import{c as O,p as Q,a as V,P as W,H as X,b as Y,L as Z,T as ee,d as ae}from"./pointCalculation-C5D4Bni4.js";function te({seriesId:r,seriesName:m}){return e.jsx(w,{to:"/player/series/$serieId",params:{serieId:r.toString()},className:"block bg-turf/10 hover:bg-turf/20 border border-turf/20 rounded-xl p-4 transition-all duration-200 group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v,{className:"h-5 w-5 text-turf"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-turf font-semibold uppercase",children:"Part of a Series"}),e.jsx("h4",{className:"font-semibold text-charcoal group-hover:text-fairway transition-colors",children:m})]})]}),e.jsx($,{className:"h-5 w-5 text-turf/50 group-hover:text-fairway transition-colors"})]})})}function oe(){const{competitionId:r}=D({strict:!1}),m=E({strict:!1}),f=m==null?void 0:m.fromTeeTime,y=()=>{const t=window.location.hash.replace("#","");return t==="leaderboard"?"leaderboard":t==="teamresult"?"teamresult":"startlist"},[a,i]=d.useState(y),[b,g]=d.useState(null),{data:s,isLoading:N}=R(r?parseInt(r):0),{data:c}=F((s==null?void 0:s.course_id)||0),{data:p}=B((s==null?void 0:s.series_id)||0),{data:h,isLoading:L,refetch:x}=H(r?parseInt(r):0),{data:u,isLoading:j,refetch:l}=M(r?parseInt(r):0),{data:n}=U(b||0),C=t=>{g(t)},S=()=>{g(null)},T=d.useCallback(()=>{window.history.back()},[]),I=h&&h.length>0&&c?{id:c.id.toString(),name:c.name,holes:h[0].pars.map((t,o)=>({number:o+1,par:t}))}:null,k=n?{id:n.id,team_name:n.team_name,position_name:n.position_name,player_names:n.player_names,score:n.score,tee_time_id:n.tee_time_id}:null;if(d.useEffect(()=>{const t=()=>{const o=window.location.hash.replace("#","");i(o==="leaderboard"?"leaderboard":o==="teamresult"?"teamresult":"startlist")};return window.addEventListener("hashchange",t),()=>window.removeEventListener("hashchange",t)},[]),d.useEffect(()=>{if(a==="leaderboard"||a==="teamresult"){const t=`lastFetch-${a}-${r}`,o=sessionStorage.getItem(t);(o?Date.now()-parseInt(o):1/0)>1e4&&(console.log(`Initial fetch for ${a} view...`),l(),a==="teamresult"&&x(),sessionStorage.setItem(t,Date.now().toString()))}},[a,r,l,x]),d.useEffect(()=>{if(!r||a!=="leaderboard"&&a!=="teamresult")return;const t=setInterval(()=>{console.log(`Periodic sync for ${a} view...`),l(),a==="teamresult"&&x()},3e4);return()=>clearInterval(t)},[a,r,l,x]),N)return e.jsx("div",{className:"p-4 text-charcoal font-primary",children:"Loading competition..."});if(!s)return e.jsx("div",{className:"p-4 text-charcoal font-primary",children:"Competition not found"});const P=O(h),_=u?Q(V(u.map(t=>({...t,participantId:t.participant.id}))),p==null?void 0:p.length):[];return e.jsxs("div",{className:"min-h-screen flex flex-col bg-scorecard",children:[e.jsx(A,{onBackClick:T,children:e.jsxs("div",{className:"flex items-center gap-4",children:[f&&e.jsxs(w,{to:`/player/competitions/${r}/tee-times/${f}`,className:"flex items-center gap-2 px-3 py-2 bg-coral text-scorecard rounded-xl hover:bg-[#E8890A] hover:-translate-y-0.5 transition-all duration-200 text-sm font-medium font-primary border border-coral",children:[e.jsx(W,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Back to"}),e.jsx("span",{children:"Score"})]}),e.jsx(X,{})]})}),e.jsxs("div",{className:"flex-1 space-y-4 md:space-y-6 p-4 md:p-6",children:[e.jsx("div",{className:"text-center",children:e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-fairway font-display",children:s.name})}),e.jsx("div",{className:"bg-rough bg-opacity-30 rounded-xl p-4 border border-soft-grey",children:e.jsxs("div",{className:"flex items-center justify-center gap-4 md:gap-8 text-xs md:text-sm text-charcoal font-primary",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(K,{className:"h-3 w-3 md:h-4 md:w-4 text-turf"}),e.jsx("span",{className:"hidden sm:inline",children:new Date(s.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx("span",{className:"sm:hidden",children:new Date(s.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"h-3 w-3 md:h-4 md:w-4 text-turf"}),e.jsx("span",{className:"truncate",children:(c==null?void 0:c.name)||"Loading..."})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(z,{className:"h-3 w-3 md:h-4 md:w-4 text-turf"}),e.jsxs("span",{children:[P," participants"]})]})]})}),(s==null?void 0:s.series_id)&&s.series_name&&e.jsx(te,{seriesId:s.series_id,seriesName:s.series_name}),e.jsx("div",{className:"border-b border-soft-grey",children:e.jsxs("nav",{className:"flex space-x-4 md:space-x-8",children:[e.jsxs("button",{onClick:()=>{i("startlist"),window.location.hash=""},className:`flex items-center gap-1 md:gap-2 py-3 md:py-4 px-1 border-b-2 font-medium text-xs md:text-sm transition-colors font-primary
                ${a==="startlist"?"border-coral text-coral":"border-transparent text-charcoal hover:text-turf hover:border-rough"}
              `,children:[e.jsx(G,{className:"h-3 w-3 md:h-4 md:w-4"}),"Start List"]}),e.jsxs("button",{onClick:()=>{i("leaderboard"),window.location.hash="leaderboard",console.log("Syncing data for leaderboard view..."),l()},className:`flex items-center gap-1 md:gap-2 py-3 md:py-4 px-1 border-b-2 font-medium text-xs md:text-sm transition-colors font-primary
                ${a==="leaderboard"?"border-coral text-coral":"border-transparent text-charcoal hover:text-turf hover:border-rough"}
              `,children:[e.jsx(v,{className:"h-3 w-3 md:h-4 md:w-4"}),"Leaderboard"]}),e.jsxs("button",{onClick:()=>{i("teamresult"),window.location.hash="teamresult",console.log("Syncing data for team results view..."),l(),x()},className:`flex items-center gap-1 md:gap-2 py-3 md:py-4 px-1 border-b-2 font-medium text-xs md:text-sm transition-colors font-primary
                ${a==="teamresult"?"border-coral text-coral":"border-transparent text-charcoal hover:text-turf hover:border-rough"}
              `,children:[e.jsx(J,{className:"h-3 w-3 md:h-4 md:w-4"}),"Team Result"]})]})}),a==="startlist"&&e.jsx(Y,{teeTimes:h,teeTimesLoading:L,competitionId:r}),a==="leaderboard"&&e.jsx(Z,{leaderboard:u,leaderboardLoading:j,onParticipantClick:C}),a==="teamresult"&&e.jsx(ee,{teamResults:_,leaderboardLoading:j})]}),e.jsx(ae,{visible:b!==null,participant:k,course:I,onClose:S})]})}export{oe as default};
