import{j as e,L as g,a as j,C as E,b as R,c as F,r as d,d as B,e as H,f as M,g as U,h as A,i as K,k as q,l as z,m as G,n as J,U as O,o as Q,p as V}from"./index-DBd_pnBE.js";import{c as W,P as X,H as Y,a as Z,L as ee,T as ae,b as te}from"./TeamResultComponent-Cs61Azll.js";function se({seriesId:t,seriesName:m}){return e.jsx(g,{to:"/player/series/$serieId",params:{serieId:t.toString()},className:"block bg-turf/10 hover:bg-turf/20 border border-turf/20 rounded-xl p-4 transition-all duration-200 group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(j,{className:"h-5 w-5 text-turf"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-turf font-semibold uppercase",children:"Part of a Series"}),e.jsx("h4",{className:"font-semibold text-charcoal group-hover:text-fairway transition-colors",children:m})]})]}),e.jsx(E,{className:"h-5 w-5 text-turf/50 group-hover:text-fairway transition-colors"})]})})}function ie(){const{competitionId:t}=R({strict:!1}),m=F({strict:!1}),p=m==null?void 0:m.fromTeeTime,w=()=>{const r=window.location.hash.replace("#","");return r==="leaderboard"?"leaderboard":r==="teamresult"?"teamresult":"startlist"},[a,i]=d.useState(w),[u,f]=d.useState(null),{data:s,isLoading:v}=B(t?parseInt(t):0),{data:c}=H((s==null?void 0:s.course_id)||0);M((s==null?void 0:s.series_id)||0);const{data:h,isLoading:y,refetch:x}=U(t?parseInt(t):0),{data:b,isLoading:N,refetch:l}=A(t?parseInt(t):0),{data:L,isLoading:C,refetch:S}=K(t?parseInt(t):0),{data:n}=q(u||0),T=r=>{f(r)},I=()=>{f(null)},k=d.useCallback(()=>{window.history.back()},[]),P=h&&h.length>0&&c?{id:c.id.toString(),name:c.name,holes:h[0].pars.map((r,o)=>({number:o+1,par:r}))}:null,_=n?{id:n.id,team_name:n.team_name,position_name:n.position_name,player_names:n.player_names,score:n.score,tee_time_id:n.tee_time_id}:null;if(d.useEffect(()=>{const r=()=>{const o=window.location.hash.replace("#","");i(o==="leaderboard"?"leaderboard":o==="teamresult"?"teamresult":"startlist")};return window.addEventListener("hashchange",r),()=>window.removeEventListener("hashchange",r)},[]),d.useEffect(()=>{if(a==="leaderboard"||a==="teamresult"){const r=`lastFetch-${a}-${t}`,o=sessionStorage.getItem(r);(o?Date.now()-parseInt(o):1/0)>1e4&&(console.log(`Initial fetch for ${a} view...`),l(),a==="teamresult"&&x(),sessionStorage.setItem(r,Date.now().toString()))}},[a,t,l,x]),d.useEffect(()=>{if(!t||a!=="leaderboard"&&a!=="teamresult")return;const r=setInterval(()=>{console.log(`Periodic sync for ${a} view...`),l(),a==="teamresult"&&x()},3e4);return()=>clearInterval(r)},[a,t,l,x]),v)return e.jsx("div",{className:"p-4 text-charcoal font-primary",children:"Loading competition..."});if(!s)return e.jsx("div",{className:"p-4 text-charcoal font-primary",children:"Competition not found"});const $=W(h),D=L||[];return e.jsxs("div",{className:"min-h-screen flex flex-col bg-scorecard",children:[e.jsx(z,{onBackClick:k,children:e.jsxs("div",{className:"flex items-center gap-4",children:[p&&e.jsxs(g,{to:`/player/competitions/${t}/tee-times/${p}`,className:"flex items-center gap-2 px-3 py-2 bg-coral text-scorecard rounded-xl hover:bg-[#E8890A] hover:-translate-y-0.5 transition-all duration-200 text-sm font-medium font-primary border border-coral",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Back to"}),e.jsx("span",{children:"Score"})]}),e.jsx(Y,{})]})}),e.jsxs("div",{className:"flex-1 space-y-4 md:space-y-6 p-4 md:p-6",children:[e.jsx("div",{className:"text-center",children:e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-fairway font-display",children:s.name})}),e.jsx("div",{className:"bg-rough bg-opacity-30 rounded-xl p-4 border border-soft-grey",children:e.jsxs("div",{className:"flex items-center justify-center gap-4 md:gap-8 text-xs md:text-sm text-charcoal font-primary",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"h-3 w-3 md:h-4 md:w-4 text-turf"}),e.jsx("span",{className:"hidden sm:inline",children:new Date(s.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx("span",{className:"sm:hidden",children:new Date(s.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(J,{className:"h-3 w-3 md:h-4 md:w-4 text-turf"}),e.jsx("span",{className:"truncate",children:(c==null?void 0:c.name)||"Loading..."})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(O,{className:"h-3 w-3 md:h-4 md:w-4 text-turf"}),e.jsxs("span",{children:[$," participants"]})]})]})}),(s==null?void 0:s.series_id)&&s.series_name&&e.jsx(se,{seriesId:s.series_id,seriesName:s.series_name}),e.jsx("div",{className:"border-b border-soft-grey",children:e.jsxs("nav",{className:"flex space-x-4 md:space-x-8",children:[e.jsxs("button",{onClick:()=>{i("startlist"),window.location.hash=""},className:`flex items-center gap-1 md:gap-2 py-3 md:py-4 px-1 border-b-2 font-medium text-xs md:text-sm transition-colors font-primary
                ${a==="startlist"?"border-coral text-coral":"border-transparent text-charcoal hover:text-turf hover:border-rough"}
              `,children:[e.jsx(Q,{className:"h-3 w-3 md:h-4 md:w-4"}),"Start List"]}),e.jsxs("button",{onClick:()=>{i("leaderboard"),window.location.hash="leaderboard",console.log("Syncing data for leaderboard view..."),l()},className:`flex items-center gap-1 md:gap-2 py-3 md:py-4 px-1 border-b-2 font-medium text-xs md:text-sm transition-colors font-primary
                ${a==="leaderboard"?"border-coral text-coral":"border-transparent text-charcoal hover:text-turf hover:border-rough"}
              `,children:[e.jsx(j,{className:"h-3 w-3 md:h-4 md:w-4"}),"Leaderboard"]}),e.jsxs("button",{onClick:()=>{i("teamresult"),window.location.hash="teamresult",console.log("Syncing data for team results view..."),l(),S(),x()},className:`flex items-center gap-1 md:gap-2 py-3 md:py-4 px-1 border-b-2 font-medium text-xs md:text-sm transition-colors font-primary
                ${a==="teamresult"?"border-coral text-coral":"border-transparent text-charcoal hover:text-turf hover:border-rough"}
              `,children:[e.jsx(V,{className:"h-3 w-3 md:h-4 md:w-4"}),"Team Result"]})]})}),a==="startlist"&&e.jsx(Z,{teeTimes:h,teeTimesLoading:y,competitionId:t}),a==="leaderboard"&&e.jsx(ee,{leaderboard:b,leaderboardLoading:N,onParticipantClick:T}),a==="teamresult"&&e.jsx(ae,{teamResults:D,leaderboardLoading:C,individualResults:b})]}),e.jsx(te,{visible:u!==null,participant:_,course:P,onClose:I})]})}export{ie as default};
