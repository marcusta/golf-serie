import{j as e,L as j,a as y,C as E,b as R,c as F,r as d,d as B,e as U,f as A,g as M,h as H,i as K,k as q,P as z,l as G,m as J,U as O,n as Q,o as V}from"./index-CKRckG41.js";import{c as W,P as X,L as Y,T as Z,a as ee,b as ae}from"./TeamResultComponent-CSM82XLp.js";function te({seriesId:s,seriesName:m}){return e.jsx(j,{to:"/player/series/$serieId",params:{serieId:s.toString()},className:"block bg-turf/10 hover:bg-turf/20 border border-turf/20 rounded-xl p-4 transition-all duration-200 group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(y,{className:"h-5 w-5 text-turf"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-turf font-semibold uppercase",children:"Part of a Series"}),e.jsx("h4",{className:"font-semibold text-charcoal group-hover:text-fairway transition-colors",children:m})]})]}),e.jsx(E,{className:"h-5 w-5 text-turf/50 group-hover:text-fairway transition-colors"})]})})}function ie(){const{competitionId:s}=R({strict:!1}),m=F({strict:!1}),p=m==null?void 0:m.fromTeeTime,w=()=>{const r=window.location.hash.replace("#","");return r==="leaderboard"?"leaderboard":r==="teamresult"?"teamresult":"startlist"},[t,o]=d.useState(w),[u,f]=d.useState(null),{data:a,isLoading:v}=B(s?parseInt(s):0),{data:c}=U((a==null?void 0:a.course_id)||0);A((a==null?void 0:a.series_id)||0);const{data:h,isLoading:N,refetch:x}=M(s?parseInt(s):0),{data:b,isLoading:L,refetch:l}=H(s?parseInt(s):0),{data:C,isLoading:S,refetch:T}=K(s?parseInt(s):0),{data:n}=q(u||0),g=r=>{f(r)},I=()=>{f(null)},P=d.useCallback(()=>{window.history.back()},[]),k=h&&h.length>0&&c?{id:c.id.toString(),name:c.name,holes:h[0].pars.map((r,i)=>({number:i+1,par:r}))}:null,_=n?{id:n.id,team_name:n.team_name,position_name:n.position_name,player_names:n.player_names,score:n.score,tee_time_id:n.tee_time_id}:null;if(d.useEffect(()=>{const r=()=>{const i=window.location.hash.replace("#","");o(i==="leaderboard"?"leaderboard":i==="teamresult"?"teamresult":"startlist")};return window.addEventListener("hashchange",r),()=>window.removeEventListener("hashchange",r)},[]),d.useEffect(()=>{if(t==="leaderboard"||t==="teamresult"){const r=`lastFetch-${t}-${s}`,i=sessionStorage.getItem(r);(i?Date.now()-parseInt(i):1/0)>1e4&&(console.log(`Initial fetch for ${t} view...`),l(),t==="teamresult"&&x(),sessionStorage.setItem(r,Date.now().toString()))}},[t,s,l,x]),d.useEffect(()=>{if(!s||t!=="leaderboard"&&t!=="teamresult")return;const r=setInterval(()=>{console.log(`Periodic sync for ${t} view...`),l(),t==="teamresult"&&x()},3e4);return()=>clearInterval(r)},[t,s,l,x]),v)return e.jsx("div",{className:"p-4 text-charcoal font-primary",children:"Loading competition..."});if(!a)return e.jsx("div",{className:"p-4 text-charcoal font-primary",children:"Competition not found"});const $=W(h),D=C||[];return e.jsxs(z,{title:a.name,onBackClick:P,seriesId:a.series_id,seriesName:a.series_name,customActions:e.jsx("div",{className:"flex items-center gap-4",children:p&&e.jsxs(j,{to:`/player/competitions/${s}/tee-times/${p}`,className:"flex items-center gap-2 px-3 py-2 bg-coral text-scorecard rounded-xl hover:bg-[#E8890A] hover:-translate-y-0.5 transition-all duration-200 text-sm font-medium font-primary border border-coral",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Back to"}),e.jsx("span",{children:"Score"})]})}),children:[e.jsxs("div",{className:"flex-1 space-y-4 md:space-y-6 p-4 md:p-6",children:[e.jsx("div",{className:"text-center",children:e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-fairway font-display",children:a.name})}),e.jsx("div",{className:"bg-rough bg-opacity-30 rounded-xl p-4 border border-soft-grey",children:e.jsxs("div",{className:"flex items-center justify-center gap-4 md:gap-8 text-xs md:text-sm text-charcoal font-primary",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"h-3 w-3 md:h-4 md:w-4 text-turf"}),e.jsx("span",{className:"hidden sm:inline",children:new Date(a.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx("span",{className:"sm:hidden",children:new Date(a.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(J,{className:"h-3 w-3 md:h-4 md:w-4 text-turf"}),e.jsx("span",{className:"truncate",children:(c==null?void 0:c.name)||"Loading..."})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(O,{className:"h-3 w-3 md:h-4 md:w-4 text-turf"}),e.jsxs("span",{children:[$," participants"]})]})]})}),(a==null?void 0:a.series_id)&&a.series_name&&e.jsx(te,{seriesId:a.series_id,seriesName:a.series_name}),e.jsx("div",{className:"border-b border-soft-grey",children:e.jsxs("nav",{className:"flex space-x-4 md:space-x-8",children:[e.jsxs("button",{onClick:()=>{o("startlist"),window.location.hash=""},className:`flex items-center gap-1 md:gap-2 py-3 md:py-4 px-1 border-b-2 font-medium text-xs md:text-sm transition-colors font-primary
                ${t==="startlist"?"border-coral text-coral":"border-transparent text-charcoal hover:text-turf hover:border-rough"}
              `,children:[e.jsx(Q,{className:"h-3 w-3 md:h-4 md:w-4"}),"Start List"]}),e.jsxs("button",{onClick:()=>{o("leaderboard"),window.location.hash="leaderboard",console.log("Syncing data for leaderboard view..."),l()},className:`flex items-center gap-1 md:gap-2 py-3 md:py-4 px-1 border-b-2 font-medium text-xs md:text-sm transition-colors font-primary
                ${t==="leaderboard"?"border-coral text-coral":"border-transparent text-charcoal hover:text-turf hover:border-rough"}
              `,children:[e.jsx(y,{className:"h-3 w-3 md:h-4 md:w-4"}),"Leaderboard"]}),e.jsxs("button",{onClick:()=>{o("teamresult"),window.location.hash="teamresult",console.log("Syncing data for team results view..."),l(),T(),x()},className:`flex items-center gap-1 md:gap-2 py-3 md:py-4 px-1 border-b-2 font-medium text-xs md:text-sm transition-colors font-primary
                ${t==="teamresult"?"border-coral text-coral":"border-transparent text-charcoal hover:text-turf hover:border-rough"}
              `,children:[e.jsx(V,{className:"h-3 w-3 md:h-4 md:w-4"}),"Team Result"]})]})}),t==="startlist"&&e.jsx(X,{teeTimes:h,teeTimesLoading:N,competitionId:s}),t==="leaderboard"&&e.jsx(Y,{leaderboard:b,leaderboardLoading:L,onParticipantClick:g}),t==="teamresult"&&e.jsx(Z,{teamResults:D,leaderboardLoading:S,individualResults:b,onParticipantClick:g})]}),e.jsx(ee,{visible:u!==null,participant:_,course:k,onClose:I})]})}export{ie as default};
